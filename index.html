<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo Oculto Navide√±oüéÖ</title>
    <!-- Usando Inter de Google Fonts para mayor legibilidad -->
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <!-- Tailwind CSS (Para una base de estilo moderna) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Confetti para celebrar el BINGO -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
    <style>
        /* --- ESTILOS CSS NAVIDE√ëOS Y T√ÅCTILES --- */
        :root {
            /* Colores de referencia */
            --color-rojo-navidad: #c0392b; /* Rojo m√°s oscuro para contraste */
            --color-verde-navidad: #27ae60;
            --color-dorado-navidad: #f1c40f;
            --color-fondo-claro: #ecf0f1;
        }

        body {
            font-family: 'Inter', sans-serif; 
            min-height: 100vh;
            background-color: var(--color-fondo-claro);
            color: #2c3e50;
        }

        /* Estilo para el t√≠tulo Great Vibes */
        h1 {
            font-family: 'Great Vibes', cursive;
            color: var(--color-rojo-navidad);
            text-shadow: 2px 2px var(--color-dorado-navidad);
        }

        /* Contenedor del Cart√≥n */
        #tarjeta-contenedor {
            display: grid;
            grid-template-columns: repeat(3, 100px); 
            grid-template-rows: repeat(3, 100px);
            gap: 8px; 
            border: 8px solid var(--color-rojo-navidad);
            background-color: var(--color-verde-navidad);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.5);
            border-radius: 15px; 
        }

        /* MEDIA QUERY para pantallas m√°s grandes */
        @media (min-width: 600px) {
            #tarjeta-contenedor {
                grid-template-columns: repeat(3, 120px);
                grid-template-rows: repeat(3, 120px);
            }
        }

        .casilla {
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-size: 14px; 
            font-weight: 700; 
            padding: 5px;
            position: relative;
            user-select: none;
            overflow: hidden;
            border-radius: 8px; 
            cursor: default;
            transition: all 0.3s ease-in-out;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
        }

        /* Estado Oculto (Caja de Regalo) */
        .casilla::before {
            content: 'üéÅ';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: var(--color-rojo-navidad); 
            color: white;
            font-size: 40px; 
            transition: opacity 0.5s;
        }

        /* Estado Revelado */
        .revelada::before {
            opacity: 0;
            pointer-events: none;
        }
        
        .revelada {
            background-color: white;
            color: #1a1a1a;
            border: 2px solid var(--color-dorado-navidad);
            transform: scale(1.05);
        }
        
        /* Resaltado para la l√≠nea ganadora */
        .resaltado-bingo {
            background-color: var(--color-dorado-navidad) !important;
            color: var(--color-rojo-navidad) !important;
            border-color: var(--color-rojo-navidad) !important;
            animation: pulse-bingo 0.8s infinite alternate;
        }

        @keyframes pulse-bingo {
            0% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1.08); opacity: 0.9; }
        }

        /* Animaci√≥n temporal de acierto */
        .acierto {
            animation: acierto-flash 0.5s ease-out;
        }

        @keyframes acierto-flash {
            0% { box-shadow: 0 0 0 0px var(--color-dorado-navidad); }
            50% { box-shadow: 0 0 0 5px rgba(241, 196, 15, 0.7); }
            100% { box-shadow: 0 0 0 0px var(--color-dorado-navidad); }
        }
        
        .bingo-alcanzado {
            color: var(--color-rojo-navidad);
            font-size: 1.6rem; 
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.9; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* Ocultar el panel de herramientas por defecto para el jugador */
        #herramientas-organizador {
            margin-top: 40px;
            padding: 20px;
            border: 2px dashed #95a5a6;
            background-color: #f8f9fa;
        }

        /* Estilo de Bot√≥n para consistencia t√°ctil */
        #btn-buscar, .btn-primary, #btn-borrar-progreso {
            transition: transform 0.1s, box-shadow 0.1s;
        }
        #btn-buscar:active, .btn-primary:active, #btn-borrar-progreso:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

    </style>
</head>
<body class="flex flex-col items-center p-4">

    <h1 class="text-4xl md:text-5xl my-4">üéÖ ¬°Bingo Navide√±o en Familia! üéÑ</h1>
    
    <!-- ID de la tarjeta (Visible para el jugador, √∫til para depuraci√≥n/identificaci√≥n) -->
    <div id="card-id" class="text-lg mb-6 bg-yellow-400 text-red-700 p-2 rounded-xl shadow-lg border-2 border-red-700 font-bold">
        Tu Tarjeta ID: <span id="tarjeta-id-valor">Cargando...</span>
    </div>

    <!-- Controles y Formulario de B√∫squeda -->
    <div id="controles" class="w-full max-w-lg p-5 bg-white rounded-xl border-4 border-green-600 border-dashed shadow-xl text-center mb-6">
        <p class="mb-3 font-semibold text-gray-700">Introduce la palabra adivinada (Ej: de la m√≠mica o charada):</p>
        <div class="flex flex-row gap-2 justify-center">
            <input type="text" id="input-palabra" placeholder="Ej: La respuesta secreta" class="p-3 w-2/3 border-2 border-green-600 rounded-lg focus:ring-green-700 focus:border-green-700" autocomplete="off">
            <button id="btn-buscar" class="btn-primary w-1/3 p-3 bg-green-600 hover:bg-green-700 text-white font-bold rounded-lg shadow-md">
                Buscar
            </button>
        </div>
        <div id="mensaje-jugador" class="mt-3 font-extrabold text-red-600 min-h-[2rem]"></div>
    </div>
    
    <!-- Contenedor del Cart√≥n de Bingo -->
    <div id="tarjeta-contenedor">
    </div>
    
    <!-- --- HERRAMIENTAS OCULTAS DEL ORGANIZADOR (PARA TI) --- -->
    <div id="herramientas-organizador" class="w-full max-w-2xl text-center">
        <h2 class="text-xl font-bold mb-3 text-gray-700">‚öôÔ∏è Herramientas de Organizaci√≥n</h2>
        <p class="text-sm text-gray-600 mb-4">Usa estos enlaces para enviar tarjetas √∫nicas a cada jugador. Esta secci√≥n no es visible en el juego.</p>

        <!-- Generador de Enlaces -->
        <div class="mb-6 border p-3 rounded-lg bg-white shadow-inner">
            <h3 class="font-semibold mb-2 text-lg">Generador de Enlaces (1 a 12)</h3>
            <div id="lista-enlaces" class="text-left text-sm space-y-1">
                <!-- Los enlaces se generan aqu√≠ por JS -->
            </div>
        </div>

        <!-- Borrar Progreso -->
        <div class="border p-3 rounded-lg bg-red-50 shadow-inner">
            <h3 class="font-semibold mb-2 text-lg text-red-700">Restauraci√≥n de Juego</h3>
            <p class="text-sm text-red-600 mb-3">¬°CUIDADO! Esto borra el progreso guardado (casillas reveladas) de **TODAS** las tarjetas en este navegador.</p>
            <button id="btn-borrar-progreso" class="p-2 bg-red-600 hover:bg-red-700 text-white font-bold rounded-lg shadow-md transition-all">
                üóëÔ∏è Borrar Progreso de Todos los Jugadores
            </button>
            <div id="mensaje-borrado" class="mt-2 text-sm font-bold text-green-700"></div>
        </div>
    </div>
    <!-- -------------------------------------------------------- -->

    <script>
        // --- L√ìGICA JAVASCRIPT ---

        // Lista de 15 palabras (pel√≠culas/conceptos) para la base del Bingo
        const PALABRAS_BASE = [
            "It", "Piratas del Caribe", "Cenicienta", "Blancanieves", 
            "Harry Potter", "Titanic", "Shrek", "Gladiador", 
            "Tarzan", "Buscando a Nemo", "Ironman", "El rey Le√≥n", 
            "Matrix", "El jorobado de Notre Dame", "Hombres de Negro"
        ];
        
        const CASILLAS_REQUERIDAS = 9; 
        const MAX_TARJETAS = 12; // M√°ximo de tarjetas √∫nicas a generar
        
        const TARJETAS_PREDEFINIDAS = []; // Array para almacenar las 12 tarjetas
        
        let tarjetaPalabras = []; // Las 9 palabras de la tarjeta actual
        let estadoCasillasReveladas = []; // Almacenar√° el estado [true/false, ...]
        let indiceTarjeta = -1; // √çndice de la tarjeta actual (0 a 11)
        let tarjetaID = ''; // ID de la tarjeta (NAV-T01, NAV-T02, etc.)

        const contenedor = document.getElementById('tarjeta-contenedor');
        const inputPalabra = document.getElementById('input-palabra');
        const btnBuscar = document.getElementById('btn-buscar');
        const mensajeJugadorDiv = document.getElementById('mensaje-jugador');
        const tarjetaIdSpan = document.getElementById('tarjeta-id-valor');
        const herramientasDiv = document.getElementById('herramientas-organizador');
        const listaEnlacesDiv = document.getElementById('lista-enlaces');
        const btnBorrarProgreso = document.getElementById('btn-borrar-progreso');
        const mensajeBorradoDiv = document.getElementById('mensaje-borrado');
        
        // Patrones ganadores para 3x3
        const PATRONES_GANADORES = [
            [0, 1, 2], [3, 4, 5], [6, 7, 8], // Filas
            [0, 3, 6], [1, 4, 7], [2, 5, 8], // Columnas
            [0, 4, 8], [2, 4, 6]            // Diagonales
        ];

        // --- INICIO: FUNCIONES DE ACCESIBILIDAD Y FEEDBACK ---
        
        const AudioContext = window.AudioContext || window.webkitAudioContext;
        let audioCtx; 

        function tocarTono(frecuencia, duracion, tipo) {
            if (!audioCtx) { audioCtx = new AudioContext(); }

            const oscillator = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            
            const wave = tipo === 'bingo' ? 'sine' : (tipo === 'correcto' ? 'square' : 'sawtooth');
            
            oscillator.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            
            oscillator.type = wave;
            oscillator.frequency.setValueAtTime(frecuencia, audioCtx.currentTime);
            
            gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duracion / 1000);

            oscillator.start();
            oscillator.stop(audioCtx.currentTime + duracion / 1000);
        }
        
        function vibrar(patron) {
            if (navigator.vibrate) {
                navigator.vibrate(patron);
            }
        }
        
        function manejarResultado(tipo) {
            switch (tipo) {
                case 'correcto':
                    tocarTono(880, 150, 'correcto'); 
                    vibrar(100); 
                    break;
                case 'incorrecto':
                    tocarTono(220, 300, 'incorrecto'); 
                    vibrar([50, 50, 50]);
                    break;
                case 'ya_revelada':
                    tocarTono(440, 200, 'incorrecto'); 
                    vibrar(200); 
                    break;
                case 'bingo':
                    tocarTono(1200, 800, 'bingo'); 
                    vibrar([500, 100, 500]);
                    break;
            }
        }
        // --- FIN: FUNCIONES DE ACCESIBILIDAD Y FEEDBACK ---


        // --- FUNCI√ìN DE CONFETI ---
        function lanzarConfeti() {
            const coloresNavidad = ['#c0392b', '#27ae60', '#f1c40f']; 
            
            confetti({
                particleCount: 150, spread: 90, origin: { y: 0.6 },
                colors: coloresNavidad, startVelocity: 40, scalar: 0.9, ticks: 300
            });
            
             confetti({
                particleCount: 100, spread: 120, origin: { y: 0.4 },
                colors: coloresNavidad, startVelocity: 50, scalar: 0.7, ticks: 200
            });
        }

        // --- FUNCIONES AUXILIARES DE JUEGO ---

        // Funci√≥n para normalizar texto (ignora tildes, may√∫sculas y signos)
        function normalizarTexto(texto) {
            const sinTildes = texto.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
            return sinTildes.toLowerCase().trim().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()]/g,"").replace(/\s{2,}/g," ");
        }

        // CORRECCI√ìN CR√çTICA: Implementaci√≥n de Generador Pseudoaleatorio Congruencial Lineal (LCG)
        // para garantizar que el orden de las tarjetas sea el mismo en cada recarga (determinista).
        // Si usamos Math.random(), el orden cambia, rompiendo el guardado de progreso.
        function lcg(seed) {
            let a = 1664525;
            let c = 1013904223;
            let m = 4294967296; // 2^32
            let state = seed;
            
            // Devuelve una funci√≥n que genera n√∫meros aleatorios entre 0 y 1 basados en la semilla inicial
            return function() {
                state = (a * state + c) % m;
                return state / m; 
            };
        }

        // Funci√≥n de mezclar array que acepta una funci√≥n de aleatoriedad (semilla)
        function mezclarArray(array, randomFunc) {
            for (let i = array.length - 1; i > 0; i--) {
                // Usa la funci√≥n pseudoaleatoria basada en la semilla o Math.random() por defecto
                const rand = randomFunc ? randomFunc() : Math.random(); 
                const j = Math.floor(rand * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
        
        function generarTarjetaID(index) {
            return `NAV-T${String(index + 1).padStart(2, '0')}`;
        }
        
        function preGenerarTarjetas() {
            for (let i = 0; i < MAX_TARJETAS; i++) {
                // La semilla es el √≠ndice de la tarjeta + 1 (para evitar la semilla 0)
                const seed = i + 1; 
                const randomGenerator = lcg(seed);
                
                // 1. Crear una copia de las palabras base
                let palabrasAbarajar = [...PALABRAS_BASE]; 
                
                // 2. Barajar la copia usando la semilla espec√≠fica
                // Esto asegura que Tarjeta 1 siempre tiene el mismo orden, Tarjeta 2 el mismo orden, etc.
                const palabrasMezcladas = mezclarArray(palabrasAbarajar, randomGenerator);
                
                // 3. Tomar las 9 requeridas
                const tarjetaCompleta = palabrasMezcladas.slice(0, CASILLAS_REQUERIDAS);
                TARJETAS_PREDEFINIDAS.push(tarjetaCompleta);
            }
        }
        
        function guardarEstadoLocal() {
            const estado = {
                reveladas: estadoCasillasReveladas
            };
            // Usamos el ID de la tarjeta como clave para guardar el progreso de cada jugador
            localStorage.setItem(tarjetaID, JSON.stringify(estado));
        }

        function cargarEstadoLocal() {
            const estadoGuardado = localStorage.getItem(tarjetaID);
            if (estadoGuardado) {
                const estado = JSON.parse(estadoGuardado);
                if (estado.reveladas && estado.reveladas.length === CASILLAS_REQUERIDAS) {
                    estadoCasillasReveladas = estado.reveladas;
                    return true;
                }
            }
            return false;
        }
        
        // --- L√ìGICA DE ASIGNACI√ìN Y RENDERIZADO ---

        function asignarTarjeta() {
            const urlParams = new URLSearchParams(window.location.search);
            let indiceJugadorParam = urlParams.get('jugador');
            
            // Si el par√°metro 'organizador' est√° presente, mostramos las herramientas
            if (urlParams.has('organizador')) {
                herramientasDiv.style.display = 'block';
                generarEnlacesJugador();
            } else {
                herramientasDiv.style.display = 'none';
            }

            // 1. Determinar el √≠ndice de la tarjeta (0-MAX_TARJETAS-1)
            let indiceSeleccionado = 0; // Por defecto Tarjeta 1
            if (indiceJugadorParam !== null) {
                const num = parseInt(indiceJugadorParam);
                if (!isNaN(num) && num >= 1 && num <= MAX_TARJETAS) {
                    indiceSeleccionado = num - 1; 
                }
            } else if (urlParams.has('organizador') === false) {
                 // Si NO es el organizador y no hay par√°metro, seleccionamos una al azar para evitar que todos vean T01
                 // NOTA: Usamos Math.random() aqu√≠ S√ìLO si no se especifica jugador, para que la primera vez sea aleatorio.
                 indiceSeleccionado = Math.floor(Math.random() * MAX_TARJETAS);
            }
            
            indiceTarjeta = indiceSeleccionado;

            // 2. Establecer datos de la tarjeta
            tarjetaPalabras = TARJETAS_PREDEFINIDAS[indiceTarjeta];
            tarjetaID = generarTarjetaID(indiceTarjeta); 
            tarjetaIdSpan.textContent = tarjetaID;
            
            // 3. Cargar estado y Renderizar
            if (!cargarEstadoLocal()) {
                estadoCasillasReveladas = new Array(CASILLAS_REQUERIDAS).fill(false);
            }
            
            renderizarTarjeta();
        }

        function renderizarTarjeta() {
            contenedor.innerHTML = '';
            let casillasReveladasCount = 0;
            
            tarjetaPalabras.forEach((palabra, index) => {
                const casilla = document.createElement('div');
                casilla.classList.add('casilla');
                casilla.dataset.index = index;
                casilla.dataset.palabraNormalizada = normalizarTexto(palabra); 
                casilla.innerHTML = `<span>${palabra}</span>`;
                
                if (estadoCasillasReveladas[index]) {
                    casilla.classList.add('revelada');
                    casillasReveladasCount++;
                }

                contenedor.appendChild(casilla);
            });
            
            // Verificar si el BINGO ya estaba alcanzado al cargar
            const patronGanador = verificarBingo();
            if (patronGanador) {
                finalizarJuego(patronGanador);
            } else if (casillasReveladasCount > 0) {
                 mensajeJugadorDiv.textContent = `Progreso cargado para ${tarjetaID}. ¬°Sigue buscando tu l√≠nea de 3!`;
            } else {
                 mensajeJugadorDiv.textContent = `¬°Introduce la palabra secreta de la actividad!`;
            }
        }
        
        // --- L√ìGICA DEL BINGO ---

        function verificarBingo() {
            // Devuelve el patr√≥n ganador (un array de √≠ndices) o null si no hay BINGO
            const esRevelada = (i) => estadoCasillasReveladas[i];
            
            for (const patron of PATRONES_GANADORES) {
                if (patron.every(esRevelada)) {
                    return patron; // ¬°Patr√≥n ganador encontrado!
                }
            }
            return null; // No hay BINGO
        }
        
        function finalizarJuego(patronGanador) {
            mensajeJugadorDiv.innerHTML = `<span class="bingo-alcanzado">üéâ ¬°BINGO GANADOR! ¬°Felicidades, ve y busca tu regalo! üéâ</span>`;
            btnBuscar.disabled = true;
            inputPalabra.disabled = true;

            // Resaltar las casillas ganadoras (CR√çTICO)
            const casillas = document.querySelectorAll('.casilla');
            patronGanador.forEach(index => {
                if (casillas[index]) {
                    casillas[index].classList.add('resaltado-bingo');
                    // Asegurarse de que est√°n reveladas y con el texto visible
                    casillas[index].classList.add('revelada');
                    casillas[index].classList.remove('acierto'); 
                }
            });

            lanzarConfeti(); 
            manejarResultado('bingo'); 
        }

        // --- L√ìGICA DE B√öSQUEDA Y REVELACI√ìN PRINCIPAL ---
        function buscarYRevelar() {
            if (!audioCtx) { audioCtx = new AudioContext(); }
            
            const palabraBusqueda = normalizarTexto(inputPalabra.value);
            inputPalabra.value = ''; // Limpiar el input

            if (!palabraBusqueda) {
                mensajeJugadorDiv.textContent = "¬°Por favor, escribe la respuesta adivinada!";
                return;
            }

            let encontrada = false;
            let yaRevelada = false;
            let bingoAlcanzado = null; // Usamos null para el patr√≥n ganador
            const casillas = document.querySelectorAll('.casilla');
            
            // 1. Buscar y marcar
            tarjetaPalabras.forEach((palabra, index) => {
                if (normalizarTexto(palabra) === palabraBusqueda) {
                    encontrada = true;
                    if (estadoCasillasReveladas[index]) {
                        yaRevelada = true;
                    } else {
                        // Revelar
                        casillas[index].classList.add('revelada');
                        casillas[index].classList.add('acierto');
                        setTimeout(() => casillas[index].classList.remove('acierto'), 500); 

                        estadoCasillasReveladas[index] = true; // Actualiza el estado
                        
                        bingoAlcanzado = verificarBingo();
                    }
                }
            });
            
            // 2. Feedback y Guardado
            if (bingoAlcanzado) {
                guardarEstadoLocal(); 
                finalizarJuego(bingoAlcanzado);
            } else if (encontrada && !yaRevelada) {
                guardarEstadoLocal(); 
                mensajeJugadorDiv.textContent = `¬°"${palabraBusqueda.toUpperCase()}" ENCONTRADA! Sigue buscando tu l√≠nea de 3.`;
                manejarResultado('correcto'); 
            } else if (yaRevelada) {
                 mensajeJugadorDiv.textContent = `¬°"${palabraBusqueda.toUpperCase()}" ya hab√≠a sido revelada!`;
                 manejarResultado('ya_revelada'); 
            } else {
                mensajeJugadorDiv.textContent = `"${palabraBusqueda.toUpperCase()}" NO est√° en tu cart√≥n.`;
                manejarResultado('incorrecto'); 
            }
        }
        
        // --- L√ìGICA DE HERRAMIENTAS DEL ORGANIZADOR ---

        function generarEnlacesJugador() {
            const baseUrl = window.location.href.split('?')[0]; // URL base sin par√°metros
            listaEnlacesDiv.innerHTML = '';

            for (let i = 1; i <= MAX_TARJETAS; i++) {
                const link = `${baseUrl}?jugador=${i}`;
                const listItem = document.createElement('div');
                const tarjetaId = generarTarjetaID(i - 1);
                
                listItem.innerHTML = `
                    <span class="font-bold text-gray-800">${tarjetaId}:</span> 
                    <a href="${link}" target="_blank" class="text-blue-600 hover:underline break-words">${link}</a>
                    <button data-link="${link}" class="ml-2 text-xs bg-gray-200 hover:bg-gray-300 p-1 rounded transition-colors" onclick="copiarAlPortapapeles(this)">Copiar</button>
                `;
                listaEnlacesDiv.appendChild(listItem);
            }
        }
        
        // Funci√≥n global para copiar el enlace
        window.copiarAlPortapapeles = function(button) {
            const link = button.getAttribute('data-link');
            // Usamos un m√©todo de fallback ya que navigator.clipboard no siempre funciona en iframes
            const textarea = document.createElement('textarea');
            textarea.value = link;
            document.body.appendChild(textarea);
            textarea.select();
            
            try {
                document.execCommand('copy');
                button.textContent = '¬°Copiado!';
                setTimeout(() => button.textContent = 'Copiar', 1500);
            } catch (err) {
                console.error('No se pudo copiar el texto: ', err);
                button.textContent = 'Error al copiar';
            }
            document.body.removeChild(textarea);
        };

        function borrarTodoElProgreso() {
            let keysToDelete = [];
            // Recorrer localStorage y buscar las claves que inician con 'NAV-T'
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('NAV-T')) {
                    keysToDelete.push(key);
                }
            }
            
            keysToDelete.forEach(key => {
                localStorage.removeItem(key);
            });

            mensajeBorradoDiv.textContent = `‚úÖ ${keysToDelete.length} registros de progreso borrados.`;
            // Recargar la p√°gina para limpiar el estado actual del jugador
            setTimeout(() => {
                 window.location.href = window.location.href.split('?')[0]; // Recargar la URL base
            }, 1000);
        }

        // --- EVENT LISTENERS ---
        
        btnBuscar.addEventListener('click', buscarYRevelar);
        inputPalabra.addEventListener('keyup', function(e) { 
            if (e.key === 'Enter') {
                buscarYRevelar();
            }
        });
        btnBorrarProgreso.addEventListener('click', borrarTodoElProgreso);

        // INICIALIZAR EL JUEGO
        window.onload = function() {
            preGenerarTarjetas();
            asignarTarjeta();
        };

    </script>
</body>
</html>